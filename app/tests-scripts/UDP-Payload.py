import socket
import time 

HOSTNAME = "fe80::292f:2eda:aa83:cf63" # "fe80::ba27:ebff:fe3b:fa24"  # "fe80::292f:2eda:aa83:cf62"  # "fe80::b06b:248a:5da5:7513"

UDP_PORT = 15118

TCP_PORT = 15443

MSG1 = [0x01,0xFE,0x90,0x00,0x00,0x00,0x00,0x02,0x10,00]

MSG2 = [0xD7, 0x36, 0x74, 0x46, 0x56, 0x60, 0x04, 0x00, 0x00, 0x08, 0x00, 0x80]

#MSG3 = [0x

#MSG2 = [0x01,0xFE,0x80,0x01,0x00,0x00,0x00,0x44,0x80,0x00,0xDB,0xAB,0x93,0x71,0xD3,0x23,0x4B,0x71,0xD1,0xB9,0x81,0x89,0x91,0x89,0xD1,0x91,0x81,0x89,0x91,0xD2,0x6B,0x9B]

#MSG3 = [0x01,0xFE,0x80,0x01,0x00,0x00,0x00,0x15,0x80,0x98,0x02,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x11,0xD0,0x18,0x08,0x00,0x00,0x00,0x00,0x04,0x00]

#MSG4 = [0x01,0xFE,0x80,0x01,0x00,0x00,0x00,0x1E,0x80,0x98,0x02,0x09,0xB1,0x84,0xD8,0x50,0xAA,0xF5,0xD0,0x11,0xB0,0x20,0xEE,0xEE,0xEE,0x5C,0xEC,0xCA,0xC6,0xE8,0xDE,0xE4]

#MSG5 = [0xD8,0x32,0xEF,0x22,0x6E,0x10,0x8C,0x49,0xB8,0xD5,0x21,0x60,0x98,0xFB,0xA3,0x96,0x88,0x4B,0x0F,0x4E,0xF5,0x7F,0xB6,0x3D,0xB0,0x22,0x10,0x08,0xE1,0x6E,0x82,0x83]

#MSG6 = [0xD8,0x32,0xEF,0x22,0x6E,0x10,0x8C,0x49,0xB8,0xD5,0x21,0x60,0x98,0xFB,0xA3,0x96,0x88,0x4B,0x0F,0x4E,0xF5,0x7F,0xB6,0x3D,0xB0,0x22,0x10,0x08,0xE1,0x6E,0x82,0x83]


buffer = bytes(MSG1)

buffer2 = bytes(MSG2)

print ("Target IPv6 Address:", HOSTNAME)

print ("Target UDP Port:", UDP_PORT)

 # print ("message:", MSG1)

sock = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM) # UDP

print ("1. Sending SECC Discovery Req. Message: ", MSG1)

sock.sendto(buffer, (HOSTNAME, UDP_PORT,0,0));

# time.sleep(2)

# print ("2. Sending Session Setup Req. Message: ", MSG2)

# sock.sendto(buffer2, (HOSTNAME, UDP_PORT,0,0));

print ("-----")
print ("-----")
print ("-----")

while True:

    data, addr = sock.recvfrom(1024) # buffer size is 1024 bytes

    print ("received message from CANoe EVSE: ", data)
